package net.ccbluex.liquidbounce.features.module.modules.exploit.disabler.other

import net.ccbluex.liquidbounce.event.PacketEvent
import net.ccbluex.liquidbounce.features.module.modules.exploit.disabler.DisablerMode
import net.ccbluex.liquidbounce.value.BoolValue
import net.ccbluex.liquidbounce.utils.MovementUtils
import net.minecraft.network.play.client.CPacketKeepAlive
import net.minecraft.network.play.client.CPacketConfirmTransaction
import net.minecraft.network.play.client.CPacketAnimation
import net.minecraft.network.play.client.CPacketEntityAction
import net.minecraft.network.play.client.CPacketPlayerDigging
import net.minecraft.network.play.client.CPacketPlayerAbilities
import net.minecraft.network.play.client.CPacketPlayer


class BasicDisabler : DisablerMode("Basic") {
    private val cancelC00Value = BoolValue("${valuePrefix}CancelC00", false)
    private val cancelC0FValue = BoolValue("${valuePrefix}CancelC0F", false)
    private val cancelC0AValue = BoolValue("${valuePrefix}CancelC0A", false)
    private val cancelC0BValue = BoolValue("${valuePrefix}CancelC0B", false)
    private val cancelC07Value = BoolValue("${valuePrefix}CancelC07", false)
    private val cancelC13Value = BoolValue("${valuePrefix}CancelC13", false)
    private val cancelC03Value = BoolValue("${valuePrefix}CancelC03", false)
    private val c03NoMoveValue = BoolValue("${valuePrefix}C03-NoMove", false).displayable { cancelC03Value.get() }
    
    override fun onPacket(event: PacketEvent) {
        val packet = event.packet
        if (packet is CPacketKeepAlive && cancelC00Value.get()) {
            event.cancelEvent()
            disabler.debugMessage("Cancel C00-KeepAlive")
        }
        if (packet is CPacketConfirmTransaction && cancelC0FValue.get()) {
            event.cancelEvent()
            disabler.debugMessage("Cancel C0F-Transaction")
        }
        if (packet is CPacketAnimation && cancelC0AValue.get()) {
            event.cancelEvent()
            disabler.debugMessage("Cancel C0A-Swing")
        }
        if (packet is CPacketEntityAction && cancelC0BValue.get()) {
            event.cancelEvent()
            disabler.debugMessage("Cancel C0B-Action")
        }
        if (packet is CPacketPlayerDigging && cancelC07Value.get()) {
            event.cancelEvent()
            disabler.debugMessage("Cancel C07-Digging")
        }
        if (packet is CPacketPlayerAbilities && cancelC13Value.get()) {
            event.cancelEvent()
            disabler.debugMessage("Cancel C13-Abilities")
        }
        if (packet is CPacketPlayer && cancelC03Value.get()) {
            if (c03NoMoveValue.get() && MovementUtils.isMoving)
                return
            event.cancelEvent()
            disabler.debugMessage("Cancel C03-Flying")
        }
    }
}
